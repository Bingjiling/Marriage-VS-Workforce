---
title: "FES map"
author: "Group 7"
date: "February 1, 2016"
output: html_document
---
```{r}
library(dplyr)
library(ggplot2)
library(choroplethr)
library(choroplethrMaps)
```

```{r}
statenames <- read.csv("../data/statenames.csv", strip.white = TRUE)
statenames <- rename(statenames, ST = code, ST_name = name, ST_abbr = abbr)
hp <- readRDS("../data/hp.RDS")
hp <- tbl_df(hp)
hp <- left_join(hp, statenames)
hp_fes1to4 <- filter(hp, FES >= 1 & FES <= 4) %>% distinct(SERIALNO)
hp_fes1_state <- hp_fes1to4 %>% group_by(ST_name) %>% summarise(count = n())

# hp_fes1to3 <- filter(hp, FES >= 1 & FES <= 3)
# hp_fes1to3 <- mutate(hp_fes1to3, FES_recode = NA)
# # Recode FES variable to -1 if only male in labor force, 1 if only female (among married-couple families)
# hp_fes1to3$FES_recode[hp_fes1to3$FES == 1] <- 0
# hp_fes1to3$FES_recode[hp_fes1to3$FES == 2] <- -1
# hp_fes1to3$FES_recode[hp_fes1to3$FES == 3] <- 1
# 
# hp_fes1to3_state <- hp_fes1to3 %>% group_by(ST_name) %>% 
#                     summarise(value = mean(FES_recode, na.rm = TRUE)) %>% 
#                     arrange(value) %>% rename(region = ST_name)
# hp_fes1to3_state$region <- tolower(hp_fes1to3_state$region)
```

```{r}
fes_state_map <- state_choropleth(hp_fes1to3_state, zoom = hp_fes1to3_state$region[c(-34, -36)],
                                  title = "Single-")
fes_state_map <- fes_state_map + scale_fill_brewer(palette = 5)
fes_state_map <- fes_state_map + coord_map(projection = "albers", lat0 = 29.5, lat1 = 45.5)
fes_state_map
